### login page
GET {{host}}/login

### well-known/openid-configuration
GET {{host}}/.well-known/openid-configuration

### well-known/openid-configuration
GET {{host}}/.well-known/oauth-authorization-server

### gain a new access token for M2M interaction
POST {{host}}/oauth2/token
Content-Type: application/x-www-form-urlencoded

client_id=admin&client_secret=secret&grant_type=client_credentials&scope=admin:signup admin:key-editor admin:key-reader admin:email-verify admin:client-app-writer

> {% client.global.set("auth_token", response.body.access_token); %}

### sign up a new account

POST {{host}}/api/accounts
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "email": "user@email.com",
  "password": "secret!",
  "firstName": "Admin",
  "lastName": "",
  "birthDate": "1990-01-01",
  "phone": "+39 233 2323233",
  "locale": "it",
  "authorities": [
    "ROLE_USER",
    "VAUTHENTICATOR_ADMIN"
  ]
}


### send a mail verify challenge

PUT {{host}}/api/verify-challenge
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "email": "xxx@email.com"
}


### sign up a new account

PUT {{host}}/api/client-applications/user-introspection
Content-Type: application/json
Authorization: Bearer {{auth_token}}

{
  "clientAppName": "user-introspection",
  "secret": "s#cr#t!@#",
  "withPkce": "false",
  "storePassword": "true",
  "scopes": ["openid", "email", "profile", "mfa:enrollment"],
  "authorizedGrantTypes": ["authorization_code"],
  "webServerRedirectUri": "http://user-introspection.com:7070/login/oauth2/code/client",
  "accessTokenValidity": "360",
  "refreshTokenValidity": "360",
  "postLogoutRedirectUri": "http://user-introspection.com:7070",
  "logoutUri": "http://user-introspection.com:7070"
}


### enroll new email

POST {{host}}/api/mfa/enrollment
Content-Type: application/json
Authorization: Bearer eyJraWQiOiI4OTBmMGVjNi0xNzE4LTQyMmQtOTkwNS1mODcwZTZlN2Y2ZTAiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ1c2VyQGVtYWlsLmNvbSIsImF1ZCI6InVzZXItaW50cm9zcGVjdGlvbiIsIm5iZiI6MTcyMzU2NzM0MywidXNlcl9uYW1lIjoidXNlckBlbWFpbC5jb20iLCJzY29wZSI6WyJtZmE6ZW5yb2xsbWVudCIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJpc3MiOiJodHRwOi8vbG9jYWwuYXBpLnZhdXRoZW50aWNhdG9yLmNvbTo5MDkwIiwiZXhwIjoxNzIzNTY3NzAzLCJpYXQiOjE3MjM1NjczNDMsImp0aSI6IjE0YmQyNzgxLTY0NTItNDA2MS1hNGFkLWExYzM0MDQyZDdjZCIsImF1dGhvcml0aWVzIjpbIlJPTEVfVVNFUiIsIlZBVVRIRU5USUNBVE9SX0FETUlOIl19.6jdkj2SWmnzc7iHI7U35_bfPTPqor6KlkH_V_cU9KXy0uYHqO55nkZqFRimsqSldjBrRZgyarQCQmMQ_hnb1spnaLfSk_21ddwA_sp-mhzplwNUn4J4QEh0NB9ldG4xaAE4DPmOAtrVrVN3FnYAJLiPkWkUIHZg_STiziCHg7-vHjKtQvu8AMbs1cQT076gpOnr0Bvg-UsmrIMS2V-8M7lTWO5n-ZakwascZ5MWMISXpqEio9mWHJoEZvO4SRKFh9r8Z19Y7NeFqnBR35k8_ADzAyHUNEIiqb4H9Mh_oXD5Wl5bPUO6KjcS1rGZLeOHgBqTzWgUTSZ2YNHZp7Rnr-g

{
  "mfaMethod": "EMAIL_MFA_METHOD",
  "mfaChannel" : "alternative_mfa_user@email.com"
}


### associate new email

POST {{host}}/api/mfa/associate
Content-Type: application/json
Authorization: Bearer eyJraWQiOiI4OTBmMGVjNi0xNzE4LTQyMmQtOTkwNS1mODcwZTZlN2Y2ZTAiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ1c2VyQGVtYWlsLmNvbSIsImF1ZCI6InVzZXItaW50cm9zcGVjdGlvbiIsIm5iZiI6MTcyMzU2NzM0MywidXNlcl9uYW1lIjoidXNlckBlbWFpbC5jb20iLCJzY29wZSI6WyJtZmE6ZW5yb2xsbWVudCIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJpc3MiOiJodHRwOi8vbG9jYWwuYXBpLnZhdXRoZW50aWNhdG9yLmNvbTo5MDkwIiwiZXhwIjoxNzIzNTY3NzAzLCJpYXQiOjE3MjM1NjczNDMsImp0aSI6IjE0YmQyNzgxLTY0NTItNDA2MS1hNGFkLWExYzM0MDQyZDdjZCIsImF1dGhvcml0aWVzIjpbIlJPTEVfVVNFUiIsIlZBVVRIRU5USUNBVE9SX0FETUlOIl19.6jdkj2SWmnzc7iHI7U35_bfPTPqor6KlkH_V_cU9KXy0uYHqO55nkZqFRimsqSldjBrRZgyarQCQmMQ_hnb1spnaLfSk_21ddwA_sp-mhzplwNUn4J4QEh0NB9ldG4xaAE4DPmOAtrVrVN3FnYAJLiPkWkUIHZg_STiziCHg7-vHjKtQvu8AMbs1cQT076gpOnr0Bvg-UsmrIMS2V-8M7lTWO5n-ZakwascZ5MWMISXpqEio9mWHJoEZvO4SRKFh9r8Z19Y7NeFqnBR35k8_ADzAyHUNEIiqb4H9Mh_oXD5Wl5bPUO6KjcS1rGZLeOHgBqTzWgUTSZ2YNHZp7Rnr-g

{
  "ticket": "8257fe9c-39ab-43bf-a775-6c21501fceba",
  "code" : "873361"
}

### change default mfa

PUT {{host}}/api/mfa/device
Content-Type: application/json
Authorization: Bearer eyJraWQiOiIwNmM5YjQ0NS1jNzRlLTRlYjgtOWRjZC01MzFlMmJmZjdjOTEiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ1c2VyQGVtYWlsLmNvbSIsImF1ZCI6InVzZXItaW50cm9zcGVjdGlvbiIsIm5iZiI6MTcyMzI0MDY5NiwidXNlcl9uYW1lIjoidXNlckBlbWFpbC5jb20iLCJzY29wZSI6WyJtZmE6ZW5yb2xsbWVudCIsIm9wZW5pZCIsImVtYWlsIiwicHJvZmlsZSJdLCJpc3MiOiJodHRwOi8vbG9jYWwuYXBpLnZhdXRoZW50aWNhdG9yLmNvbTo5MDkwIiwiZXhwIjoxNzIzMjQxMDU2LCJpYXQiOjE3MjMyNDA2OTYsImp0aSI6IjdhZTdhMjM2LTY1YjQtNDdlMC1iMTE0LTIyYmIyNWE1YmM5NiIsImF1dGhvcml0aWVzIjpbIlJPTEVfVVNFUiIsIlZBVVRIRU5USUNBVE9SX0FETUlOIl19.EHoW43U0g_f9At7HWQoVIrf4J8bbCmz61MJ2JpsecocJ1al8UXHOclaMvoQ8OJx-tCp1qiZrpgg8IIT8bZ0gpwQUX8kjvnVubYHKnW29lKlVdAft5vL5aSlrBWsO0Ufjs4VJUDyuRZEJr6fWIEu-m5pgdcDDlvp_zp82Kc0SFFh1XDZGyf7mv8Hys63KJ2xx8cINEsBY_1bnM0mE6pRHUEZoR8XM2RZmFmTm4paN-6cEgSEmRHsJKvQ53decvDPWNnvzXhuIQbr2_sUycvROe5fnU2rkHm_mjFwZR4u3EvN9rKnM0-jIXw5elq4G9bpC2DEsCsKtyqibaOU_XgJJ8w

{
  "deviceId": "54e1a350-05bb-4ed2-b39c-565c3b162168"
}